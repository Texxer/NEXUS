# GitHub Ruleset Recommendations for NEXUS IDE

## Overview

This document provides recommended branch protection rules for the NEXUS repository on GitHub to ensure code quality, security, and stability.

---

## Recommended Ruleset Configuration

### 1. **Ruleset Name**: `Production Branch Protection`

### 2. **Target Branches**: `master` (and `main` if applicable)

---

## Rules Configuration

### ✅ **Restrict Creations**

- **Status**: ENABLED
- **Purpose**: Only users with admin/bypass permissions can create matching refs
- **Rationale**: Prevents accidental branch creation; enforces workflow discipline

### ✅ **Restrict Updates**

- **Status**: ENABLED  
- **Purpose**: Only users with bypass permission can update protected refs
- **Rationale**: Ensures all changes go through pull request process

### ✅ **Restrict Deletions**

- **Status**: ENABLED
- **Purpose**: Prevent accidental deletion of protected branches
- **Rationale**: Protects production/master branch from being deleted

### ✅ **Require Linear History**

- **Status**: ENABLED
- **Purpose**: Prevent merge commits; require rebasing or squashing
- **Rationale**: Keeps commit history clean and easy to audit; good for CI/CD

### ✅ **Block Force Pushes**

- **Status**: ENABLED
- **Purpose**: Prevent `git push --force` to protected branches
- **Rationale**: Protects against accidental history rewrites

### ✅ **Require a Pull Request Before Merging**

- **Status**: ENABLED
- **Configuration**:
  - **Required Approvals**: `1` (for solo dev) or `2` (for team)
  - **Dismiss stale PR approvals**: ENABLED
  - **Require review from Code Owners**: ENABLED
  - **Require approval of most recent push**: ENABLED
  - **Require conversation resolution**: ENABLED

- **Rationale**: All code changes must be reviewed; prevents merging without proper review

### ✅ **Allowed Merge Methods**

- **Enabled Options**:
  - ✅ Squash and merge
  - ✅ Rebase and merge
  - ❌ Create a merge commit (disabled due to linear history requirement)

- **Rationale**: Enforces linear history; keeps commits atomic

### ✅ **Require Status Checks to Pass**

- **Status**: ENABLED
- **Check**: `cargo build` (Rust compilation)
- **Additional**: Add any CI checks if using GitHub Actions

- **Rationale**: Only allow merges when code compiles successfully

### ✅ **Require Branches to be Up to Date**

- **Status**: ENABLED
- **Rationale**: PR must pass checks on latest code from target branch

### ✅ **Require Signed Commits**

- **Status**: ENABLED (if team uses GPG keys)
- **Purpose**: All commits must have verified signatures
- **Rationale**: Enhances security and attribution

---

## Bypass List (Recommended: Empty)

Keep bypass list empty unless you have specific admin automation needs.

---

## Implementation Steps

### Step 1: Go to Repository Settings

1. Navigate to `https://github.com/Texxer/NEXUS/settings/rules`
2. Click **"New branch ruleset"**

### Step 2: Configure Ruleset

1. **Name**: `Production Branch Protection`
2. **Enforcement**: Set to `Active` (not "Evaluate")

### Step 3: Set Target Branches

1. Click **"Add branch"**
2. Select **"Branch name"** → Type: `master`

### Step 4: Enable Rules

- [x] Restrict creations
- [x] Restrict updates  
- [x] Restrict deletions
- [x] Require linear history
- [x] Block force pushes
- [x] Require pull request (with 1-2 approvals)
- [x] Dismiss stale approvals
- [x] Require conversation resolution
- [x] Require signed commits (optional)

### Step 5: Set Merge Methods

- [x] Squash and merge
- [x] Rebase and merge
- [ ] Create merge commit (UNCHECK)

### Step 6: Add Required Status Checks

1. Click **"Add status checks"**
2. Search for: `cargo build`
3. Select it and save

---

## What Can Be Uploaded (Minimal Set for Building)

### ✅ **MUST INCLUDE** (Essential for building)

```
Cargo.toml              # Main project manifest
Cargo.lock              # Reproducible dependency versions
src/                    # All source code
src-tauri/              # Tauri configuration
ui/                     # UI source (without node_modules)
package.json            # Node dependencies manifest
LICENSE                 # License files
README.md               # Documentation
BUILD_NEXUS.ps1         # Build script
```

### ❌ **EXCLUDE** (Building/Testing)

```
target/                 # Rust build artifacts (regenerated by cargo build)
dist/                   # Build output folder
ui/node_modules/        # NPM dependencies (reinstalled by npm install)
ui/dist/                # Built UI artifacts
.idea/                  # IDE settings (user-specific)
.vscode/                # VS Code settings (user-specific)
*.exe                   # Compiled binaries (except nexus-ide.exe for releases)
*.dll                   # Compiled libraries
.DS_Store               # macOS files
Thumbs.db               # Windows files
```

### ⚠️ **CONDITIONAL** (For Testing)

```
dist/nexus-ide.exe      # ✅ INCLUDED - Pre-built binary for quick testing
dist/config/            # ✅ INCLUDED - Configuration templates
```

---

## Build Instructions for Cloners

To build NEXUS from the repository:

```bash
# Clone
git clone https://github.com/Texxer/NEXUS.git
cd NEXUS

# Install dependencies
npm install --prefix ui/

# Build project
cargo build --release

# Or use the build script
./BUILD_NEXUS.ps1
```

---

## Benefits of This Configuration

| Benefit | How It Helps |
|---------|-------------|
| **Code Quality** | Requires review before merge |
| **Compile Safety** | Blocks breaking code from merging |
| **Audit Trail** | Signed commits = verified history |
| **Linear History** | Easy to bisect bugs |
| **Minimal Size** | Only source code tracked (~1.5 GB) |
| **Fast Clones** | No binary artifacts slowing download |
| **Reproducible Builds** | Cargo.lock ensures same dependencies |

---

## Notes

- **For Solo Development**: Set approvals to 1 (can self-review)
- **For Team**: Set approvals to 2+ (better review coverage)
- **CI/CD Integration**: Add GitHub Actions workflow to auto-check builds
- **Release Process**: Tag releases; keep pre-built exe only for latest release
